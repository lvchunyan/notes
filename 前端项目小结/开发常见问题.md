# 开发常见问题

## 缓存取不到数据

`localStorage` 和  `sessionStorage` 

localStorage用setItem方法存int类型，但是打印出来却是string类型，这个与localStorage本身的特点有关，localStorage只支持string类型的存储。

因此 用 localStorage 存储 JSON 时需先转化成    JSON字符串 ，取值时将  JSON字符串转化成  JSON

`localStorage本质上是 字符串 的储存`

```markdown
let b = {c:'11'}
localStorage.setItem('a',JSON.stringify(b))
let a = JSON.parse(localStorage.getItem('a'))
```

## 页面设置了缓存 部分数据还想获取最新的数据

常见场景：搜索列表页，每次进入页面时需保留上次的查询条件但是要获取最新的列表数据

keep-alive生命周期钩子函数：activated、deactivated

使用<keep-alive>会将数据保留在内存中，如果要在每次进入页面的时候获取最新的数据，需要在 `activated` 阶段获取数据，承担原来 `mounted` 钩子中获取数据的任务。

## 进入页面还是上次的数据，需要刷新浏览器才能请求新数据

使用了<keep-alive> 检查路由文件中 是不是没设置 notCache: true 详情页一般不需要进行缓存 每次都得请求新的数据 如果部分需设置缓存 需要在 `activated` 阶段获取数据，承担原来 `mounted` 钩子中获取数据的任务。

##  A对象赋值给B对象，修改B属性会影响到A问题

   - 方法1(推荐)： b = Object.assign({}, a); 
   
   - 方法2： b = JSON.parse(JSON.stringify(a));
   
## 模态框中的地图和图表无法显示

请在模态框显示出来后，再去调用地图和图表的初始化函数

## 列表进入详情页的传参问题

例如商品列表页面前往商品详情页面，需要传一个商品id;


```markdown
                const route = {
                  name: 'page-detail',
                  query: {id: params.row.id, pageType: this.pageTypeEnum.detail},
                  meta: {
                    title: `复杂信息详情`,
                    notCache: true
                  }
                }
                this.addTag({
                  route: route, type: 'push'
                })
                this.$router.push(route)
```

详情页面的路径为http://localhost:8080/page-detail?id=1&pageType=detail，可以看到传了一个参数id=1 pageType=detail，并且就算刷新页面id也还会存在。此时在详情页面可以通过id来获取对应的详情数据，获取id的方式是
`this.$route.query.id`

## 日期选择控件少一天问题及格式会自动变化问题

不要用v-modal来绑定 用:value 和@on-change="date=$event" 来配合

通过formate来定义想要的时间格式

```vue

<DatePicker type='date' :value='date' placeholder='请选择时间'
                          formate="yyyy-MM-dd"
                          @on-change="date=$event"></DatePicker>

```

## Select组件文本显示时不局左

```vue
<Select v-model="model11" filterable>
    <Option v-for="item in cityList" :value="item.value" :key="item.value">
    {{ item.label }}
    </Option>
</Select>
```

内容文本和Option之间不能有空格
```vue

<Select v-model="model11" filterable>
    <Option v-for="item in cityList" :value="item.value" :key="item.value">{{ item.label }}</Option>
</Select>
```

## 设计图上字体小于12px

浏览器默认最小字体为12px 但是设计图上是小于12px 

我们可以用 transform: scale(.5); 来实现 6px 

scale是css3中的缩放

## [Vue插值文本换行问题](http://www.cnblogs.com/leegent/p/9274424.html)

- 方法1. 使用v-html` 首先，将字符串里的\n替换为，然后用v-html指令渲染字符串为innerHTML。

- 方法2. 设置white-space属性（推荐） 将div容器的white-space属性设置为pre-wrap即可解决问题。

## git对源代码进行push到其他分支时可能会出错,错误信息如下: error: failed to push some refs to 'xxx(远程库)'

 ![CSDN图标](https://luohaoyu.oss-cn-beijing.aliyuncs.com/dictionary/icon-information/ba7e192d582147f19e2dc0b472bef427.png "这是CSDN的图标")
- 解决方式：git pull --rebase githubRepo master 这里面的githubRepo是远程库的名字。

## windows和linux换行符不同导致的错误
```markdown
Windows下Git使用报错：
warning：LF will be replaced by CRLF in ××××.××(文件名)
The file will have its original line ending in your working directory.
原因是：
windows中的换行符为CRLF，而Linux下的换行符为LF（使用Git命令行Git Bash，实际上就是相当于linux环境），
所以在执行git add xxx.xx操作时，会出现这个错误提示！

解决方法：
1、如果版本库/项目还没被创建，执行以下操作：
git config --global core.autocrlf false     //在全局禁用自动转换
2、如果版本库/项目已经创建，使用非全局禁用自动转换
git config core.autocrlf false                    //在当前版本库中禁用自动转换
3、如果版本库/项目已经创建，在全局禁用自动转换则需要先删除之前创建的.git 文件后添加上面的设置。 
此操作很坑！是删除整个.git，会把跟远程的链接都断掉，整个git的提交历史/版本库都会被删除！
rm -rf .git
git config --global core.autocrlf false     //在全局禁用自动转换
完成后再重新执行git创建版本库操作：
git init
git add ...
git remote add ***
这样设置git的配置后在执行add操作就没有问题了。

```

## 本地分支与远程分支断开连接
```markdown
当 git push origin branch_name时遇到报错如下：
fatal:'origin' does not appear to be a git repository
fatal:Could not read from remote repository

解决方法：
cd 本地分支里
1、git branch 
               ——*master   只显示master

查看是否从上游仓库
2、git remote –v
             ——若什么都没有，则和上游已断联系，拉不了代码也推不了代码 


加关联
3、git remote add origin ssh://git@gitlab*********************************.git(地址)


然后
4、git fetch origin

              ——会显示下拉的branch情况

                    格式为From ssh://gitlab.********************************

                  *  [new branch]         XXXXX        ->origin/XXXXX
 
再次检查远程仓库，显示对应的clone地址
git remote –v
——origin  git://github.com/schacon/ticgit.git (fetch)
origin  git://github.com/schacon/ticgit.git (push)
 
然后再查分支
git branch –a

            ——* mater

                   remotes/origin/XXXXXX         **********

```

## git push 出错
error: failed to push some refs to 'https://github.com/lvchunyan/electron-demo.git'
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Integrate the remote changes (e.g.
hint: 'git pull ...') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.

```markdown
1.使用强制push的方法：

$ git push -u origin master -f 

这样会使远程修改丢失，一般是不可取的，尤其是多人协作开发的时候。

2.push前先将远程repository修改pull下来

$ git pull origin master

$ git push -u origin master

3.若不想merge远程和本地修改，可以先创建新的分支：

$ git branch [name]

然后push

$ git push -u origin [name]

```

## git提交到远程藏库冲突解决
hint: Updates were rejected because the remote contains work that you do 
hint: not have locally. This is usually caused by another repository pushing 
hint: to the same ref. You may want to first integrate the remote changes 
hint: (e.g., 'git pull ...') before pushing again. 
hint: See the 'Note about fast-forwards' in 'git push --help' for details.
```markdown
原因: 两人同时fetch了一个分支。 第一个人修改后提交，第二个人提交就失败。

解决方法:
1.强制推送
$ git push -f 
可以提交，会将remote上第一个人的改动冲掉，比较暴力，不太好。

2.正常解决
先 git fetch origin 然后git merge origin/master, 和本地分支合并, 之后再push。
```

